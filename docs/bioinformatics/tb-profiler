# TB-profiler

In the previous sessions you have performed mapping, variant calling and annotation to find drug resistance variants in Mtb data. We also looked at the quality of the data through coverage- and depth-based metrics. A lot of commands and manual work were used to get to this final result. To make this process easier we have developed a tool called tb-profiler to automate this process and provide an end-to-end pipeline for TB resistance prediction from sequence data. The pipeline searches for small variants and big deletions associated with drug resistance and will also report the strain type (lineage). 

Let's activate the tb-profiler environment and create a folder for our results:

```
cd ~/data/example_data
mkdir tb-profiler
cd tb-profiler
```

Now we can run tb-profiler using the following command for sample1:

```
tb-profiler profile -1 ../sample1.fastq.gz --platform nanopore --prefix sample1 --txt
```

Let's break down this command:

1. profile: this tells the tool to use the profile function, which runs the whole pipeline 
2. -1 ../sample1.fastq.gz: used to provide the fastq files
3. --platform nanopore: tells the pipeline that we are using ONT data, the default for this parameter is Illumina
4. --prefix sample1: this argument allows you to provide a prefix to the resulting output files
5. --txt: specified that we want the reuslt file in text format

The results will be put into the results folder. Have a look at the text output using less:

```
less results/sample1.results.txt
```

There are a few sections in the output report:
* Summary: provides a brief summary of the the drug resistance and strain type.
* Resistance report: For each drug lists any variants found and the proportion at which they occured in the raw data. Multiple variants across different genes can arise for the same drug.
* Resistance variants report: similar to the section above but each line represents one variant and more information such as the genome position and variant type is provided.
* Other variants report: lists all variants in drug resistance candidate genes that are not associated with resistance.

